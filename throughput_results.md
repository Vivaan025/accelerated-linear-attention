```
RTX 5090 Throughput Benchmark
Batch Scaling Test


=== Sequence Length: 128 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.00         0.208           0.121           0.143           0.117           cuDNN
2        0.00         0.187           0.169           0.240           0.216           KDA
4        0.00         0.302           0.298           0.406           0.406           KDA
8        0.01         0.588           0.569           0.739           0.865           KDA
16       0.02         1.300           0.958           1.203           1.371           KDA
32       0.03         2.012           1.938           2.289           2.354           KDA
64       0.06         4.246           3.827           4.720           4.459           KDA
128      0.12         7.656           7.651           9.306           8.266           KDA
256      0.25         15.407          15.249          18.769          15.923          KDA

=== Sequence Length: 256 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.00         0.228           0.218           0.210           0.237           LogLinear
2        0.00         0.308           0.300           0.405           0.416           KDA
4        0.01         0.542           0.540           0.679           0.736           KDA
8        0.02         1.052           0.874           1.092           1.201           KDA
16       0.03         1.857           1.650           2.043           2.148           KDA
32       0.06         3.565           3.494           4.319           3.936           KDA
64       0.12         7.666           7.602           9.327           8.135           KDA
128      0.25         15.327          15.249          18.424          15.938          KDA
256      0.50         30.811          30.726          37.670          32.300          KDA

=== Sequence Length: 512 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.00         0.434           0.350           0.449           0.440           KDA
2        0.01         0.579           0.573           0.714           0.761           KDA
4        0.02         0.994           0.879           1.108           1.397           KDA
8        0.03         1.925           1.677           2.257           2.143           KDA
16       0.06         3.594           3.476           4.250           4.202           KDA
32       0.12         7.801           7.653           9.166           8.156           KDA
64       0.25         15.312          15.291          18.270          16.024          KDA
128      0.50         30.870          30.746          36.936          31.972          KDA
256      1.00         61.930          65.097          75.263          64.021          Delta

=== Sequence Length: 1024 tokens (1K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.01         0.603           0.564           0.705           0.753           KDA
2        0.02         1.014           0.885           1.121           1.256           KDA
4        0.03         1.860           1.646           2.081           2.196           KDA
8        0.06         3.562           3.489           4.256           4.288           KDA
16       0.12         7.630           7.805           9.455           8.383           Delta
32       0.25         15.448          15.321          18.448          16.217          KDA
64       0.50         30.763          30.612          36.579          34.581          KDA
128      1.00         62.251          61.367          73.123          63.982          KDA
256      2.00         122.764         122.422         146.878         126.824         KDA

=== Sequence Length: 2048 tokens (2K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.02         1.121           0.905           1.149           1.292           KDA
2        0.03         1.784           1.648           2.049           2.282           KDA
4        0.06         3.665           3.612           4.409           4.493           KDA
8        0.12         7.894           7.720           9.488           8.364           KDA
16       0.25         15.348          15.300          18.267          16.492          KDA
32       0.50         31.166          31.670          37.846          33.169          Delta
64       1.00         61.548          61.708          73.067          65.791          Delta
128      2.00         123.757         125.191         152.630         129.707         Delta
256      4.00         657.275         245.889         289.882         258.474         KDA

=== Sequence Length: 4096 tokens (4K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.03         2.128           1.584           2.000           2.371           KDA
2        0.06         3.566           3.539           4.302           4.359           KDA
4        0.12         7.663           7.619           9.306           8.691           KDA
8        0.25         15.314          15.363          18.235          17.040          Delta
16       0.50         30.703          32.050          36.419          33.966          Delta
32       1.00         61.802          61.312          73.351          67.455          KDA
64       2.00         123.428         125.375         150.714         136.953         Delta
128      4.00         249.079         248.986         295.946         275.293         KDA
256      8.00         488.745         486.630         581.581         534.194         KDA

=== Sequence Length: 8192 tokens (8K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.06         3.708           3.531           4.279           4.654           KDA
2        0.12         7.710           7.733           9.126           9.747           Delta
4        0.25         15.481          15.346          18.773          18.416          KDA
8        0.50         30.897          30.955          36.658          36.446          Delta
16       1.00         62.970          62.490          73.224          73.338          KDA
32       2.00         122.976         127.456         145.610         144.827         Delta
64       4.00         248.975         246.373         290.081         286.183         KDA
128      8.00         489.011         488.139         584.998         569.688         KDA
256      16.00        974.617         971.663         1156.762        1148.231        KDA

=== Sequence Length: 16384 tokens (16K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.12         7.950           7.821           9.305           10.889          KDA
2        0.25         15.560          15.550          18.515          21.031          KDA
4        0.50         31.610          31.177          36.941          41.780          KDA
8        1.00         62.516          62.236          74.578          82.652          KDA
16       2.00         123.697         123.717         149.860         165.123         Delta
32       4.00         252.701         254.869         294.389         331.114         Delta
64       8.00         488.737         487.142         582.833         648.869         KDA
128      16.00        977.508         976.031         1158.900        1288.102        KDA
256      32.00        50.735          46.414          45.989          44.878          cuDNN

=== Sequence Length: 32768 tokens (32K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.25         17.564          15.656          18.460          25.981          KDA
2        0.50         31.669          31.124          36.860          51.125          KDA
4        1.00         62.213          62.259          74.309          100.900         Delta
8        2.00         125.883         126.462         148.363         202.519         Delta
16       4.00         249.476         249.893         296.084         408.025         Delta
32       8.00         498.630         495.529         599.847         801.271         KDA
64       16.00        989.316         999.979         1176.720        1590.088        Delta
128      32.00        51.156          51.320          49.351          45.919          cuDNN
256      64.00        32.177          36.751          37.992          34.882          Delta

=== Sequence Length: 65536 tokens (64K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        0.50         31.181          31.183          36.874          70.277          Delta
2        1.00         62.009          62.107          73.451          138.379         Delta
4        2.00         123.216         123.987         145.840         279.160         Delta
8        4.00         246.858         245.639         291.300         553.881         KDA
16       8.00         493.488         489.319         589.273         1097.776        KDA
32       16.00        977.387         983.272         1172.423        2178.660        Delta
64       32.00        49.924          49.819          44.692          45.874          LogLinear
128      64.00        31.081          36.528          34.749          33.943          Delta
256      128.00       0.357           0.349           0.331           0.301           cuDNN

=== Sequence Length: 131072 tokens (128K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        1.00         63.828          62.487          74.743          215.825         KDA
2        2.00         128.677         130.020         153.158         427.590         Delta
4        4.00         262.588         256.876         303.455         855.128         KDA
8        8.00         528.988         520.636         614.855         1707.012        KDA
16       16.00        981.009         979.490         1161.480        3364.825        KDA
32       32.00        49.266          49.901          46.766          46.012          cuDNN
64       64.00        30.064          35.798          36.011          35.935          Delta
128      128.00       0.353           0.320           0.351           0.294           cuDNN
256      256.00       0.426           0.328           0.328           0.322           cuDNN

=== Sequence Length: 262144 tokens (256K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best
-------------------------------------------------------------------------------------------
1        2.00         125.599         127.040         150.637         722.891         Delta
2        4.00         256.572         254.870         303.261         1439.128        KDA
4        8.00         510.946         505.441         612.359         2875.674        KDA
8        16.00        976.882         972.861         1150.756        5721.152        KDA
16       32.00        50.328          47.190          48.137          45.888          cuDNN
32       64.00        32.733          36.029          37.256          35.983          Delta
64       128.00       0.319           0.299           0.297           0.304           LogLinear
128      256.00       0.355           0.372           0.324           0.370           LogLinear
256      512.00       CPU malloc failed
```
