RTX 5090 Throughput Benchmark
Batch Scaling Test


=== Sequence Length: 128 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.00         0.228           0.124           0.144           0.131           KDA
2        0.00         0.186           0.167           0.245           0.218           KDA
4        0.00         0.349           0.334           0.435           0.449           KDA
8        0.01         0.605           0.568           0.735           0.783           KDA
16       0.02         1.159           0.912           1.158           1.332           KDA
32       0.03         2.339           1.932           2.407           2.463           KDA
64       0.06         4.430           4.283           5.119           4.636           KDA
128      0.12         8.761           8.608           10.331          8.955           KDA
256      0.25         17.476          17.247          20.685          17.681          KDA

=== Sequence Length: 256 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.00         0.209           0.185           0.204           0.250           KDA
2        0.00         0.320           0.319           0.426           0.469           KDA
4        0.01         0.659           0.582           0.727           0.856           KDA
8        0.02         1.168           0.880           1.172           1.365           KDA
16       0.03         2.104           1.611           2.013           2.357           KDA
32       0.06         4.109           3.948           4.824           4.435           KDA
64       0.12         9.145           9.159           10.432          9.085           cuDNN
128      0.25         17.213          17.106          20.290          17.737          KDA
256      0.50         34.501          34.377          40.719          35.306          KDA

=== Sequence Length: 512 tokens (0K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.00         0.442           0.383           0.503           0.472           KDA
2        0.01         0.595           0.561           0.710           0.814           KDA
4        0.02         1.083           0.949           1.192           1.349           KDA
8        0.03         2.241           1.696           2.096           2.414           KDA
16       0.06         4.224           4.124           4.936           4.528           KDA
32       0.12         8.450           8.325           9.888           8.949           KDA
64       0.25         17.278          17.130          20.264          17.765          KDA
128      0.50         34.262          34.007          40.190          35.194          KDA
256      1.00         68.603          68.496          80.997          70.487          KDA

=== Sequence Length: 1024 tokens (1K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.01         0.693           0.668           0.814           0.850           KDA
2        0.02         1.161           0.920           1.161           1.417           KDA
4        0.03         2.110           1.813           2.190           2.375           KDA
8        0.06         4.124           3.977           4.783           4.449           KDA
16       0.12         8.568           8.478           9.947           9.094           KDA
32       0.25         17.313          17.325          20.110          17.890          Delta
64       0.50         34.310          34.346          40.262          35.650          Delta
128      1.00         68.707          68.251          80.352          70.766          KDA
256      2.00         137.711         136.746         160.914         141.769         KDA

=== Sequence Length: 2048 tokens (2K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.02         1.320           0.924           1.171           1.486           KDA
2        0.03         2.078           1.909           2.303           2.577           KDA
4        0.06         4.244           4.109           4.921           4.690           KDA
8        0.12         8.674           8.568           10.064          9.239           KDA
16       0.25         17.220          17.130          20.134          18.162          KDA
32       0.50         34.553          34.430          40.206          36.294          KDA
64       1.00         94.801          94.313          106.059         98.227          KDA
128      2.00         138.574         138.307         162.076         146.037         KDA
256      4.00         275.677         275.081         322.666         289.104         KDA

=== Sequence Length: 4096 tokens (4K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.03         2.422           1.923           2.314           2.643           KDA
2        0.06         4.157           4.013           4.830           4.735           KDA
4        0.12         8.554           8.463           9.947           9.744           KDA
8        0.25         17.280          17.087          20.025          18.955          KDA
16       0.50         34.534          34.183          40.284          37.606          KDA
32       1.00         69.053          68.948          81.016          75.201          KDA
64       2.00         137.724         137.283         161.293         149.687         KDA
128      4.00         275.081         274.290         321.298         297.907         KDA
256      8.00         548.110         546.073         640.667         590.971         KDA

=== Sequence Length: 8192 tokens (8K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.06         4.287           4.017           4.745           5.071           KDA
2        0.12         8.508           8.472           9.986           10.200          KDA
4        0.25         17.144          16.982          20.064          20.117          KDA
8        0.50         34.504          34.257          40.124          39.959          KDA
16       1.00         68.866          68.517          80.228          80.103          KDA
32       2.00         137.230         136.871         160.416         157.890         KDA
64       4.00         274.208         273.854         320.871         314.887         KDA
128      8.00         548.110         546.286         646.818         627.437         KDA
256      16.00        1112.055        1096.887        1551.148        1250.324        KDA

=== Sequence Length: 16384 tokens (16K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.12         8.789           8.630           10.071          11.545          KDA
2        0.25         17.310          17.114          20.089          22.747          KDA
4        0.50         34.763          34.689          49.492          45.289          KDA
8        1.00         69.437          69.082          80.943          89.377          KDA
16       2.00         136.900         136.882         161.539         177.165         KDA
32       4.00         275.362         274.458         322.092         353.798         KDA
64       8.00         550.357         548.317         649.880         703.633         KDA
128      16.00        263.099         9.443           8.955           400.422         LogLinear
256      32.00        1564.150        45.727          44.965          1571.416        LogLinear

=== Sequence Length: 32768 tokens (32K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.25         17.307          17.242          20.355          27.755          KDA
2        0.50         34.540          34.352          40.413          54.406          KDA
4        1.00         69.280          68.963          81.251          108.064         KDA
8        2.00         138.253         138.191         161.910         214.081         KDA
16       4.00         275.057         275.296         321.562         426.767         Delta
32       8.00         547.895         546.163         645.728         850.901         KDA
64       16.00        1092.595        1088.046        1288.888        1700.047        KDA
128      32.00        1537.935        45.918          43.163          1575.961        LogLinear
256      64.00        1051.136        35.399          34.081          1057.755        LogLinear

=== Sequence Length: 65536 tokens (64K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        0.50         35.418          35.423          41.440          82.877          Delta
2        1.00         68.813          68.620          80.329          146.293         KDA
4        2.00         138.334         137.856         161.478         288.203         KDA
8        4.00         273.291         273.950         321.263         573.201         Delta
16       8.00         544.739         539.809         642.788         1142.333        KDA
32       16.00        1089.808        1087.169        1280.085        2288.842        KDA
64       32.00        1558.184        44.834          44.991          1561.849        KDA
128      64.00        1043.724        36.923          37.122          1053.722        KDA
256      128.00       1.264           0.357           0.304           38.113          LogLinear

=== Sequence Length: 131072 tokens (128K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        1.00         69.070          68.850          80.529          219.961         KDA
2        2.00         137.729         137.855         161.900         437.600         Delta
4        4.00         272.919         275.283         322.542         871.345         Delta
8        8.00         546.327         541.470         638.492         1737.478        KDA
16       16.00        1090.972        1087.877        1271.848        3472.873        KDA
32       32.00        1554.243        42.809          45.185          1561.432        KDA
64       64.00        1045.116        35.056          34.742          1051.275        LogLinear
128      128.00       1.279           0.313           0.311           39.095          LogLinear
256      256.00       1.533           0.332           0.333           2.787           KDA

=== Sequence Length: 262144 tokens (256K) ===
Batch    VRAM (GB)    Delta (ms)      KDA (ms)        LogLinear (ms)  cuDNN FA (ms)   Best        
-------------------------------------------------------------------------------------------
1        2.00         138.644         138.421         162.118         735.135         KDA
2        4.00         276.214         275.735         321.095         1463.828        KDA
4        8.00         549.785         549.290         649.302         2924.036        KDA
8        16.00        1098.330        1095.859        1286.182        5844.806        KDA
16       32.00        1568.467        43.930          45.011          1572.026        KDA
32       64.00        1051.566        34.627          33.946          1063.334        LogLinear
64       128.00       1.309           0.324           0.319           38.036          LogLinear
128      256.00       1.591           0.354           0.347           2.785           LogLinear
256      512.00       CPU malloc failed
